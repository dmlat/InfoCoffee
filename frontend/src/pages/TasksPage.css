/* frontend/src/pages/TasksPage.css */

.tasks-page {
    display: flex;
    flex-direction: column;
    gap: 16px;
}

.tasks-page-layout {
    display: flex;
    flex-direction: column;
    gap: 24px;
    padding: 0;
    height: 100%;
    box-sizing: border-box;
}

.tasks-list-container,
.restock-settings-container {
    background-color: #282c34;
    padding: 0;
    border-radius: 12px;
    display: flex;
    flex-direction: column;
    gap: 0;
    flex-shrink: 0;
    overflow: hidden; /* This is key to contain the table */
}

.container-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid #3a3e47;
    padding: 8px 12px; /* Adjusted vertical padding for better centering */
    cursor: pointer;
    user-select: none;
    min-height: 38px;
    box-sizing: border-box;
}

.container-title {
    color: #e0e0e0;
    font-size: 0.9em;
    font-weight: 500;
    margin: 0;
    text-transform: none;
    display: flex;
    align-items: center;
    gap: 8px;
}

/* Override global h2 margin for TasksPage headers */
.container-header h2.container-title {
    /* Убираем глобальный отступ h2 */
    margin-bottom: 0 !important;
}

.toggle-arrow {
    display: inline-block;
    width: 0;
    height: 0;
    border-top: 5px solid transparent;
    border-bottom: 5px solid transparent;
    border-left: 6px solid #a0b0c8;
    transition: transform 0.2s ease-in-out, border-color 0.2s;
}

.toggle-arrow.open {
    transform: rotate(90deg);
}

.container-header:hover .toggle-arrow {
    border-left-color: #fff;
}

.container-header:hover .container-title {
    color: #fff;
}

/* Override generic styles from tables.css */
.tasks-list-container .data-table-container,
.restock-settings-container .data-table-container {
    background: none;
    padding: 0;
    margin-top: 0;
    border-radius: 0;
}

.data-table {
    width: 100%;
    border-collapse: collapse;
}

.data-table th,
.data-table td {
    padding: 4px 12px; /* Reduced vertical padding */
    text-align: left;
    border-bottom: 1px solid #3a3e47;
    vertical-align: middle;
}

.data-table tr:last-child td {
    border-bottom: none;
}

.data-table th {
    background-color: transparent;
    color: #a0b0c8;
    font-weight: 500;
    font-size: 0.9em;
    padding-top: 8px;
}

.settings-hint {
    font-size: 0.7em;
    color: #a0b0c8;
    padding: 2px 10px 2px;
    margin: 0;
    line-height: 1.4;
}
.settings-hint .hint-red {
    color: #e57373;
    font-weight: 500;
}
.settings-hint .hint-blue {
    color: #8ae6ff;
    font-weight: 500;
}
.settings-hint .hint-yellow {
    color: #ffb74d;
    font-weight: 500;
}

/* --- Shared Settings Table Styles --- */
.restock-table {
    table-layout: fixed;
    width: 100%;
}

.restock-table td {
    padding-top: 8px;
    padding-bottom: 8px;
    vertical-align: middle;
}

/* Column widths for restock and cleaning tables */
.restock-table th:first-child,
.restock-table td:first-child {
    width: calc(100% - 125px);
}

.restock-table th:last-child,
.restock-table td:last-child {
    width: 125px;
}

.restock-terminal-row td {
    padding-bottom: 4px;
    border-bottom: none;
}

.restock-ingredients-row td {
    padding-top: 4px;
    padding-bottom: 12px; /* Add padding to prevent ingredient pill clipping */
}

.restock-ingredients-row {
    border-bottom: 1px solid #3a3e47;
}

.restock-ingredients-row.last-terminal {
    border-bottom: none;
}

.restock-terminal-name {
    font-weight: 500;
    color: #e0e0e0;
    overflow: hidden;
    text-overflow: ellipsis;
    padding-bottom: 4px; /* Added padding to create space for sales count */
}

.ingredients-container {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    align-items: center;
}

.action-cell {
    width: 125px;
    text-align: right;
    vertical-align: middle;
}

.action-cell > button {
    margin-left: auto;
}

.sales-count-display {
    font-size: 0.8em; /* Slightly smaller than task details */
    color: #a0b0c8;
    font-weight: normal;
    white-space: nowrap;
    line-height: 1.2;
}

/* --- Ingredient Pills --- */
.ingredient-pill {
    font-size: 0.7em;
    font-weight: 500;
    padding: 3px 8px;
    border-radius: 6px;
    white-space: nowrap;
}
.ingredient-pill.critical {
    background-color: rgba(229, 115, 115, 0.2);
    color: #e57373;
}
.ingredient-pill.warning {
    background-color: rgba(255, 183, 77, 0.2);
    color: #ffb74d;
}
.ingredient-pill.normal {
    background-color: rgba(76, 175, 80, 0.15);
    color: #a0b0c8;
}

.ingredient-pill.show-more-pills {
    background-color: transparent;
    color: #8ae6ff;
    cursor: pointer;
    font-weight: 600;
    padding: 3px 8px; /* Adjusted padding to accommodate border */
    margin-left: 6px;
    border: 1px solid #4f81c7; /* Added border */
    border-radius: 6px; /* Keep existing border-radius */
    box-sizing: border-box; /* Ensure padding and border are included in width/height */
}
.ingredient-pill.show-more-pills:hover {
    text-decoration: underline;
}

/* New hint-white-bold class */
.hint-white-bold {
    color: white;
    font-weight: bold;
}

/* --- Buttons & Inputs --- */
.assignee-button {
    background: linear-gradient(135deg, #2e3340 0%, #3a3e47 100%);
    border: 1px solid #4f81c7;
    color: #e0e0e0;
    border-radius: 8px;
    padding: 6px 12px;
    cursor: pointer;
    transition: all 0.2s ease-in-out;
    white-space: nowrap;
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 0.9em;
    font-weight: 500;
    min-height: 32px;
    box-sizing: border-box;
    min-width: 100px;
    max-width: 100px;
    overflow: hidden;
    text-overflow: ellipsis;
    justify-content: center;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}
.assignee-button:hover:not(:disabled) {
    background: linear-gradient(135deg, #3a3e47 0%, #4f81c7 100%);
    border-color: #8ae6ff;
    color: #fff;
    transform: translateY(-1px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}
.assignee-button:disabled {
    background: linear-gradient(135deg, #20232a 0%, #2e3340 100%);
    border-color: #2e3340;
    color: #7a8b98;
    cursor: not-allowed;
    box-shadow: none;
}
.assignee-icon {
    width: 8px;
    height: 8px;
    background-color: #4f81c7;
    border-radius: 50%;
    flex-shrink: 0;
}
.create-task-button-inline {
    background: linear-gradient(135deg, #4f81c7 0%, #5a9ee6 100%);
    color: white;
    border: 1px solid #4f81c7;
    border-radius: 8px;
    padding: 6px 12px;
    cursor: pointer;
    font-size: 0.9em;
    font-weight: 500;
    min-height: 32px;
    box-sizing: border-box;
    white-space: nowrap;
    min-width: 100px;
    max-width: 100px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease-in-out;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}
.create-task-button-inline:hover:not(:disabled) {
    background: linear-gradient(135deg, #5a9ee6 0%, #6bb6ff 100%);
    border-color: #8ae6ff;
    transform: translateY(-1px);
    box-shadow: 0 4px 8px rgba(79, 129, 199, 0.3);
}
.create-task-button-inline:disabled {
    background: linear-gradient(135deg, #3a3e47 0%, #2e3340 100%);
    color: #7a8b98;
    cursor: not-allowed;
    border-color: #3a3e47;
    box-shadow: none;
}
.delete-btn {
    background: none;
    border: none;
    color: #b0b8c8;
    font-size: 1.5em;
    cursor: pointer;
    padding: 0 4px;
    line-height: 1;
    vertical-align: middle;
}
.delete-btn:hover {
    color: white;
}
.complete-task-button {
    background-color: #4f81c7;
    color: white;
    border: none;
    border-radius: 6px;
    padding: 6px 12px;
    font-size: 0.9em;
    font-weight: 600;
    cursor: pointer;
    transition: background-color 0.2s;
    white-space: nowrap;
}
.complete-task-button:hover {
    background-color: #5a9ee6;
}

/* --- Your Tasks & Tasks Log Tables --- */
.tasks-table {
    table-layout: fixed;
    width: 100%;
}
/* Your Tasks Block */
.tasks-table th:nth-child(1), .tasks-table td:nth-child(1) { width: 70%; }
.tasks-table th:nth-child(2), .tasks-table td:nh-child(2) { width: 30%; text-align: center; }

/* Tasks Log Block */
.tasks-log-table {
    table-layout: auto; /* Changed to auto to allow flexible column sizing */
    width: 100%;
}
.tasks-log-table th:nth-child(1), .tasks-log-table td:nth-child(1) { width: auto; /* Allow first column to shrink */ }
.tasks-log-table th:nth-child(2), .tasks-log-table td:nth-child(2) {
    /* Removed fixed width to allow content-based sizing */
    white-space: nowrap;
    text-align: center;
    padding: 0 2px !important; /* 2px padding on each side */
}
.tasks-log-table th:nth-child(3), .tasks-log-table td:nth-child(3) {
    width: 40px !important;
    min-width: 40px !important;
    max-width: 40px !important;
    white-space: nowrap;
    text-align: center;
    padding: 0 !important;
    box-sizing: border-box;
}

.tasks-table .task-cell {
    line-height: 1.3;
    padding-bottom: 20px; /* Increased padding to prevent ingredient pill clipping */
}
.tasks-table .task-cell > div {
    display: -webkit-box;
    -webkit-box-orient: vertical;
    text-overflow: ellipsis;
}
.task-terminal-name {
    font-weight: 500;
    color: #e0e0e0;
}
.task-type-name {
    font-size: 0.9em;
    color: #8ae6ff;
}
.task-details {
    font-size: 0.8em;
    color: #a0b0c8;
    white-space: normal;
}
.task-assignee-text-small {
    font-size: 0.8em;
    color: #ffb74d;
    margin-top: 2px;
    display: block;
}
.tasks-table-empty-row {
    text-align: center;
    padding: 10px 12px;
    color: #a0b0c8;
    font-size: 0.9em;
}

.task-ingredients-pills {
    display: flex;
    flex-wrap: wrap;
    gap: 4px;
    margin-top: 6px;
    margin-bottom: 8px; /* Added small bottom margin for spacing */
}

.configure-notice {
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
    margin-top: 4px;
}

.configure-notice:hover .hint-red {
    text-decoration: underline;
}

.configure-notice .arrow-icon {
    display: inline-block;
    color: #8ae6ff; /* Use hint-blue color for the arrow character */
    font-weight: bold;
    font-size: 1.2em;
    transition: transform 0.2s ease-in-out;
    animation: bounce-horizontal 1.5s infinite;
}

@keyframes bounce-horizontal {
    0%, 100% {
        transform: translateX(0);
    }
    50% {
        transform: translateX(4px);
    }
}


/* --- Status Icons & Hints --- */
.status-hint {
    font-size: 0.7em; /* Match settings-hint */
    color: #a0b0c8;
    padding: 6px 6px; /* Even more reduced padding */
    margin: 0;
    display: flex;
    flex-wrap: nowrap; /* Prevent wrapping */
    align-items: center;
    gap: 2px; /* Even more reduced gap */
    justify-content: center; /* Align to start */
    white-space: nowrap; /* Ensure text stays on one line */
    overflow: hidden; /* Hide overflow */
    text-overflow: ellipsis; /* Add ellipsis if overflow */
}
.status-hint span {
    display: flex;
    align-items: center;
    gap: 2px; /* Even smaller gap for icons */
    flex-shrink: 0;
}
.status-icon {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 16px; /* Smaller icon size */
    height: 16px; /* Smaller icon size */
    border-radius: 50%;
    font-weight: bold;
    font-size: 0.7em; /* Smaller font inside icon */
    line-height: 1;
    flex-shrink: 0;
}
.status-icon-completed {
    background-color: rgba(76, 175, 80, 0.2);
    color: #81c784;
}
.status-icon-pending {
    background-color: rgba(255, 152, 0, 0.2);
    color: #ffb74d;
    line-height: 1;
    padding-bottom: 2px;
    box-sizing: border-box;
}
.status-icon-overdue {
    background-color: rgba(244, 67, 54, 0.2);
    color: #e57373;
}

/* --- Keyframe Animations --- */
@keyframes input-glow {
    0% {
        border-color: #4f81c7;
        box-shadow: none;
    }
    50% {
        border-color: #8ae6ff;
        box-shadow: 0 0 8px rgba(138, 230, 255, 0.4);
    }
    100% {
        border-color: #4f81c7;
        box-shadow: none;
    }
}

/* Ensure the hint-blue color is applied strongly */
.sales-count-display .hint-blue {
    color: #8ae6ff !important;
}

/* --- Media Queries --- */
@media (max-width: 768px) {
    .data-table th,
    .data-table td {
        padding: 6px 8px;
        font-size: 0.9em;
    }

    .tasks-table,
    .restock-table {
        table-layout: auto;
    }

    /* Column widths for mobile */
    .restock-table th:first-child,
    .restock-table td:first-child {
        width: auto; /* Let it shrink */
    }

    .restock-table th:last-child,
    .restock-table td:last-child {
        width: 70px; /* Fixed width for action column on mobile */
    }

    .action-cell {
        width: 70px !important;
        min-width: 70px !important;
        max-width: 70px !important;
        padding: 8px 1px !important;
        box-sizing: border-box;
        text-align: center;
        overflow: hidden;
    }

    .assignee-button,
    .create-task-button-inline {
        min-width: unset;
        max-width: unset;
        width: 100%;
        padding: 1px; /* Reduced padding for small screens */
        font-size: 0.65em; /* Smaller font size */
        min-height: 24px;
        max-height: 24px;
        line-height: 1;
        box-sizing: border-box; /* Include padding and border in the element's total width and height */
    }

    /* Override specific styles for table cells to allow shrinking */
    .restock-table td {
        white-space: normal; /* Allow text to wrap */
        word-break: break-word; /* Break long words */
    }

    /* Adjust sales count display for very small screens */
    .sales-count-display {
        font-size: 0.9em !important; /* Set to match cleaning-terminal-name on mobile, added !important */
        flex-shrink: 1; /* Allow to shrink */
    }

    /* Specific adjustments for very small screens */
    @media (max-width: 375px) {
        .restock-table th:first-child,
        .restock-table td:first-child {
            width: calc(100% - 90px); /* Calculate width to ensure space for action column */
        }

        .restock-table th:last-child,
        .restock-table td:last-child {
            width: 90px; /* Ensure action column has sufficient width */
        }

        .action-cell {
            width: 90px !important;
            min-width: 90px !important;
            max-width: 90px !important;
            padding: 8px 1px !important;
            box-sizing: border-box;
            text-align: center;
            overflow: hidden;
        }

        .assignee-button,
        .create-task-button-inline {
            padding: 1px; /* Reduce button padding even more */
            font-size: 0.65em; /* Smaller font size */
            min-height: 24px; /* Ensure buttons are not too short */
            max-height: 24px;
            line-height: 1;
        }
    }

    .assignee-button,
    .create-task-button-inline {
        width: 100%;
        box-sizing: border-box;
        min-width: 0;
        padding: 4px; /* Default padding for mobile */
        font-size: 0.8em;
    }

    .ingredients-container {
        min-width: 0;
        max-width: 100%;
    }

    .tasks-table th:nth-child(1),
    .tasks-table td:nth-child(1) {
        width: 100%;
        white-space: normal;
        word-break: break-word;
    }
    .tasks-table .task-terminal-name {
        white-space: normal;
        word-break: break-word;
    }
    .tasks-table th:nth-child(2),
    .tasks-table td:nth-child(2) {
        width: auto;
        white-space: nowrap;
    }

    .restock-terminal-name {
        white-space: normal;
        word-break: break-word;
    }
}

/* Ensure the hint-blue color is applied strongly for glowing placeholder */
.cleaning-frequency-input.glowing-placeholder {
    animation: input-glow 2s infinite ease-in-out;
    border-color: #4f81c7;
    box-shadow: 0 0 8px rgba(138, 230, 255, 0.4) !important; /* Ensure glow is visible */
}

@keyframes input-glow {
    0% {
        border-color: #4f81c7;
        box-shadow: none;
    }
    50% {
        border-color: #8ae6ff;
        box-shadow: 0 0 8px rgba(138, 230, 255, 0.4);
    }
    100% {
        border-color: #4f81c7;
        box-shadow: none;
    }
}